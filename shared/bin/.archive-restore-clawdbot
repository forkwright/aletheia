#!/bin/bash
source /mnt/ssd/aletheia/shared/config/aletheia.env 2>/dev/null || true
# Emergency restore script - run from Metis if Syn bricks himself
# Usage: ssh syn@192.168.0.29 '${ALETHEIA_NOUS:-${ALETHEIA_ROOT:-/mnt/ssd/aletheia}/nous}/syn/bin/restore-clawdbot'

set -e

BACKUP="/home/syn/.clawdbot/clawdbot.json.known-good"
CONFIG="/home/syn/.clawdbot/clawdbot.json"

if [ ! -f "$BACKUP" ]; then
    echo "ERROR: No backup found at $BACKUP"
    exit 1
fi

echo "Restoring config from backup..."
cp "$BACKUP" "$CONFIG"
echo "Config restored."

echo "Restarting clawdbot..."
sudo systemctl restart clawdbot

echo "Done. Clawdbot should be back online."
