#!/bin/bash
source /mnt/ssd/aletheia/shared/config/aletheia.env 2>/dev/null || true
# Emergency restore script - run from Laptop if Syn bricks himself
# Usage: ssh syn@SERVER_IP '${ALETHEIA_NOUS:-${ALETHEIA_ROOT:-/mnt/ssd/aletheia}/nous}/syn/bin/restore-autarkia'

set -e

BACKUP="/home/syn/.autarkia/autarkia.json.known-good"
CONFIG="/home/syn/.autarkia/autarkia.json"

if [ ! -f "$BACKUP" ]; then
    echo "ERROR: No backup found at $BACKUP"
    exit 1
fi

echo "Restoring config from backup..."
cp "$BACKUP" "$CONFIG"
echo "Config restored."

echo "Restarting autarkia..."
sudo systemctl restart autarkia

echo "Done. Clawdbot should be back online."
